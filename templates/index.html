{% load static %}
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Jekyll v3.8.5">
    <title>H3Africa Participant Recruitment Database - H3APRDB</title>
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <link href="https://cdn.datatables.net/1.10.20/css/dataTables.bootstrap4.min.css">
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
    <link rel="canonical" href="https://getbootstrap.com/docs/4.3/examples/dashboard/">
    <!-- CSS CUSTOM -->
    <link rel="stylesheet" href="{% static 'css/h3aprdb.css' %}">

    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }
      body {
    font-size: .875rem;
  }
  
  .feather {
    width: 16px;
    height: 16px;
    vertical-align: text-bottom;
  }
  
  /*
   * Sidebar
   */
  
  .sidebar {
    position: fixed;
    top: 0;
    bottom: 0;
    left: 0;
    z-index: 100; /* Behind the navbar */
    padding: 48px 0 0; /* Height of navbar */
    box-shadow: inset -1px 0 0 rgba(0, 0, 0, .1);
  }
  
  .sidebar-sticky {
    position: relative;
    top: 0;
    height: calc(100vh - 48px);
    padding-top: .5rem;
    overflow-x: hidden;
    overflow-y: auto; /* Scrollable contents if viewport is shorter than content. */
  }
  
  @supports ((position: -webkit-sticky) or (position: sticky)) {
    .sidebar-sticky {
      position: -webkit-sticky;
      position: sticky;
    }
  }
  
  .sidebar .nav-link {
    font-weight: 500;
    color: #333;
  }
  
  .sidebar .nav-link .feather {
    margin-right: 4px;
    color: #999;
  }
  
  .sidebar .nav-link.active {
    color: #007bff;
  }
  
  .sidebar .nav-link:hover .feather,
  .sidebar .nav-link.active .feather {
    color: inherit;
  }
  
  .sidebar-heading {
    font-size: .75rem;
    text-transform: uppercase;
  }
  
  /*
   * Content
   */
  
  [role="main"] {
    padding-top: 133px; /* Space for fixed navbar */
  }
  
  @media (min-width: 768px) {
    [role="main"] {
      padding-top: 48px; /* Space for fixed navbar */
    }
  }
  
  /*
   * Navbar
   */
  
  .navbar-brand {
    padding-top: .75rem;
    padding-bottom: .75rem;
    font-size: 1rem;
    background-color: rgba(0, 0, 0, .25);
    box-shadow: inset -1px 0 0 rgba(0, 0, 0, .25);
  }
  
  .navbar .form-control {
    padding: .75rem 1rem;
    border-width: 0;
    border-radius: 0;
  }
  
  .form-control-dark {
    color: #fff;
    background-color: rgba(255, 255, 255, .1);
    border-color: rgba(255, 255, 255, .1);
  }
  
  .form-control-dark:focus {
    border-color: transparent;
    box-shadow: 0 0 0 3px rgba(255, 255, 255, .25);
  }

  #big_tables_wrapper .row {
    width: 100%;
    margin-right: -50px !important;
  }

  #big_tables_wrapper .pagination li {
      margin-right: 5px !important;
  }
  #big_tables_wrapper{
    width: 1172px;
  }
  
  #big_tables_wrapper .dataTables_length{
       float: left;
  }
  
  #big_tables_wrapper .dataTables_filter{
       float: right;
  }
    </style>
</head>
<body>
  <nav class="navbar navbar-dark fixed-top bg-dark flex-md-nowrap p-0 shadow">
    <a href="/">
    <img src="{% static 'media/logo_H3Africa.png' %}" alt="h3africa.org" style="height: 70px;"/>
    </a>
    {% comment %} <input class="form-control form-control-dark w-100" type="text" placeholder="Search" aria-label="Search"> {% endcomment %}
    <ul class="navbar-nav px-3">
      <li class="nav-item text-nowrap">
        <a class="nav-link" href="/">Home</a>
      </li>
      <li class="nav-item text-nowrap">
        <a class="nav-link" href="#">Login</a>
      </li>
    </ul>
  </nav>

<!--  SIDE MENU  -->
<div class="container-fluid">
  <div class="row">
    <nav class="col-md-2 d-none d-md-block bg-light sidebar">
      <div class="sidebar-sticky">
        <ul class="nav flex-column">
          <li class="nav-item">
            <a class="nav-link active" href="#">
              <span data-feather="home"></span>
              Dashboard <span class="sr-only">(current)</span>
            </a>
          </li>
          {% comment %} <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="file"></span>
              Orders
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="shopping-cart"></span>
              Products
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="users"></span>
              Customers
            </a>
          </li> {% endcomment %}
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="bar-chart-2"></span>
              Reports
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="layers"></span>
              Documentation
            </a>
          </li>
        </ul>

        <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
          <span>Saved reports</span>
          <a class="d-flex align-items-center text-muted" href="#">
            <span data-feather="plus-circle"></span>
          </a>
        </h6>
        <ul class="nav flex-column mb-2">
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="file-text"></span>
              Current month
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="file-text"></span>
              Last quarter
            </a>
          </li>
          {% comment %} <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="file-text"></span>
              Social engagement
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="file-text"></span>
              Year-end sale
            </a>
          </li> {% endcomment %}
        </ul>
      </div>
    </nav>

    <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-4">

      <!-- CONTENT HEADER -->
      <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
        <h1 class="h2">Dashboard</h1>
        <div class="btn-toolbar mb-2 mb-md-0">
          <div class="btn-group mr-2">
            <button type="button" class="btn btn-sm btn-outline-secondary">Share</button>
            <button type="button" class="btn btn-sm btn-outline-secondary">Export</button>
          </div>
          {% comment %} <button type="button" class="btn btn-sm btn-outline-secondary dropdown-toggle">
            <span data-feather="calendar"></span>
            This week
          </button> {% endcomment %}
        </div>
        
      </div>
      <h2 class="pt-4">Overal Summary</h2>
      <div class="row">
          <div class="col-xs-12 col-md-6 col-lg-3">
              <div class="panel panel-blue panel-widget ">
                  <div class="row no-padding">
                      <div class="col-sm-3 col-lg-5 widget-left">
                          {% comment %} <svg class="glyph stroked bag"><use xlink:href="#stroked-bag"></use></svg> {% endcomment %}
                          <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-bag" viewBox="0 0 16 16" style="width: 47px;height: auto;">
                            <path d="M8 1a2.5 2.5 0 0 1 2.5 2.5V4h-5v-.5A2.5 2.5 0 0 1 8 1zm3.5 3v-.5a3.5 3.5 0 1 0-7 0V4H1v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V4h-3.5zM2 5h12v9a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V5z"/>
                          </svg>
                      </div>
                      <i class="bi bi-bag"></i>
                      <div class="col-sm-9 col-lg-7 widget-right">
                          <div class="large">{{no_projects|safe}}</div>
                          <div class="text-muted">Projects</div>
                      </div>
                  </div>
              </div>
          </div>
          <div class="col-xs-12 col-md-6 col-lg-3">
              <div class="panel panel-orange panel-widget">
                  <div class="row no-padding">
                      <div class="col-sm-3 col-lg-5 widget-left">
                          <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-chat" viewBox="0 0 16 16"  style="width: 47px;height: auto;">
                            <path d="M2.678 11.894a1 1 0 0 1 .287.801 10.97 10.97 0 0 1-.398 2c1.395-.323 2.247-.697 2.634-.893a1 1 0 0 1 .71-.074A8.06 8.06 0 0 0 8 14c3.996 0 7-2.807 7-6 0-3.192-3.004-6-7-6S1 4.808 1 8c0 1.468.617 2.83 1.678 3.894zm-.493 3.905a21.682 21.682 0 0 1-.713.129c-.2.032-.352-.176-.273-.362a9.68 9.68 0 0 0 .244-.637l.003-.01c.248-.72.45-1.548.524-2.319C.743 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7-3.582 7-8 7a9.06 9.06 0 0 1-2.347-.306c-.52.263-1.639.742-3.468 1.105z"/>
                          </svg>
                      </div>
                      <div class="col-sm-9 col-lg-7 widget-right">
                          <div class="large">{{overal_expected|safe}}</div>
                          <div class="text-muted">Participants Expected</div>
                      </div>
                  </div>
              </div>
          </div>
          <div class="col-xs-12 col-md-6 col-lg-3">
              <div class="panel panel-teal panel-widget">
                  <div class="row no-padding">
                      <div class="col-sm-3 col-lg-5 widget-left">
                          <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-person-check" viewBox="0 0 16 16"  style="width: 47px;height: auto;">
                            <path d="M6 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H1s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C9.516 10.68 8.289 10 6 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/>
                            <path fill-rule="evenodd" d="M15.854 5.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L12.5 7.793l2.646-2.647a.5.5 0 0 1 .708 0z"/>
                          </svg>
                      </div>
                      <div class="col-sm-9 col-lg-7 widget-right">
                          <div class="large">{{overal_collected|safe}}</div>
                          <div class="text-muted">Participants Recruited</div>
                      </div>
                  </div>
              </div>
          </div>
          <div class="col-xs-12 col-md-6 col-lg-3">
              <div class="panel panel-red panel-widget">
                  <div class="row no-padding">
                      <div class="col-sm-3 col-lg-5 widget-left">
                          <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-graph-up" viewBox="0 0 16 16"  style="width: 47px;height: auto;">
                            <path fill-rule="evenodd" d="M0 0h1v15h15v1H0V0zm10 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V4.9l-3.613 4.417a.5.5 0 0 1-.74.037L7.06 6.767l-3.656 5.027a.5.5 0 0 1-.808-.588l4-5.5a.5.5 0 0 1 .758-.06l2.609 2.61L13.445 4H10.5a.5.5 0 0 1-.5-.5z"/>
                          </svg>
                      </div>
                      <div class="col-sm-9 col-lg-7 widget-right">
                          <div class="large">{{ progress }}%</div>
                          <div class="text-muted">Recruitment completed</div>
                      </div>
                  </div>
              </div>
          </div>
      </div>
      </br>
      <div class="progress" style="margin-top: -9px; height: 25px;">
        <div class="progress-bar progress-bar-striped active" role="progressbar"
        aria-valuenow="{{ progress }}" aria-valuemin="0" aria-valuemax="100" style="width:{{ progress }}%">
          {{ progress }}%
        </div>
      </div>
      </br>
      
      <!-- Dropdown list of projects -->
      <h2 class="pt-4">Select a Project: All H3Africa projects</h2>
      <div>
          <select id="project" onchange="window.location = this.options[this.selectedIndex].value">
              <option value = ""> Choose a project ... </option >
              <option value = "/"> All <b>H3Africa</b> projects </option >
              <option value = "/dashboard/nih"> <b>NIH</b> projects </option >
              <option value = "/dashboard/wellcome_trust"> <b>Wellcome Trust</b> projects </option >
              <option value = "/dashboard/nih-aesa-wellcome_trust"> <b>NIH/AESA/Wellcome Trust</b> projects </option >
              <option value = ""> </option >
              {% for project in project_data.values %}
                  <option value = "projects/{{project.project_id}}" > {{ project.project_name }} </option >
              {% endfor %}
          </select>
          <br><br>
      </div>
      </br>
    
      <!-- Highcharts display -->
    <h2 class="pt-4">Collection Summary by projects</h2>
	  <div id="container" style="height: 800px; margin: 0 auto"></div>

    {% comment %} <div id="piechart" style="min-width: 310px; height: 400px; max-width: 600px; margin: 0 auto"></div> {% endcomment %}

    <br><br>
    <h2 class="pt-4">Table Summary</h2>
	  <div class="table-responsive">
	    {{table_data|safe}}
	  </div>
    <br><br>
    </main>
  </div>
</div>

<!-- Chartjs libraries -->
<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/export-data.js"></script>
    <script>
      _projects = {{projects|safe}};
      _projects_expected = {{projects_expected|safe}};
      _projects_collected = {{projects_collected|safe}};
      
      Highcharts.chart('container', {
        chart: {
          type: 'bar'
        },
        title: {
          text: 'Recruitment progress'
        },
        xAxis: {
          categories: _projects
        },
        yAxis: [{
          min: 0,
          title: {
            text: 'Participants'
          }
        }, {
          title: {
            text: ''
          },
          opposite: true
        }],
        legend: {
          shadow: false
        },
        tooltip: {
          shared: true
        },
        plotOptions: {
          bar: {
            grouping: false,
            shadow: false,
            borderWidth: 0,
            dataLabels: {
              enabled: true
            }
          }
        },
        series: [{
          name: 'Expected',
          color: 'rgba(248,161,63,1)',
          data: _projects_expected,
          tooltip: {
            valueSuffix: ' Participants'
          },
          pointPadding: 0.0,
          pointPlacement: 0.0,
          yAxis: 0,
          dataLabels: {
              enabled: false
          }
        }, {
          name: 'Recruited',
          color: 'rgba(186,60,61,.9)',
          data: _projects_collected,
          tooltip: {
            valueSuffix: ' Participants'
          },
          pointPadding: 0.4,
          pointPlacement: 0.0,
          pointWidth: 6,
          yAxis: 0,
          dataLabels: {
            enable: true,
            formatter: function() {
              return Highcharts.numberFormat(this.y / this.series.chart.series[this.series.index - 1].data[this.point.index].y * 100, 0) + '%'
            }
          }
        }]
      });

    </script>
    
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
    <script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap.min.js"></script>
    <script>
    $(document).ready(function() {
    $('#big_tables').DataTable();
} );
</script>
</html>
